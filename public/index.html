<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
</head>
<body>
	<canvas id="audio_canvas"></canvas>
	<script>
		var AudioContext = window.AudioContext || window.webkitAudioContext
		var audioCtx
		try {
			audioCtx = new AudioContext()
			var request = new XMLHttpRequest()

			 //初始化 HTTP 请求参数, 配置请求类型，文件路径等
			 request.open('GET', 'demo.mp3', true)

			 // 配置数据返回类型,从服务器取回二进制数据
			 request.responseType = 'arraybuffer'

			 // 发送ajax
			 request.send()

			 // 获取完成，对音频进一步操作，解码
			 request.onload = function() {
			 	var audioData = request.response
			 	// 解码音频，分析音频
			 	audioCtx.decodeAudioData(audioData,
			 		function(buffer) {
						source = audioCtx.createBufferSource()
			 			var analyser = audioCtx.createAnalyser()

			 			source.buffer = buffer

			 			source.connect(analyser)
			 			analyser.connect(audioCtx.destination)


			 			var bufferLength = analyser.frequencyBinCount,
			 			    dataArray = new Uint8Array(analyser.frequencyBinCount)


			 			analyser.getByteFrequencyData(dataArray)

			 			var canvas = document.getElementById('audio_canvas'),
			 			    ctx = canvas.getContext("2d"),
			 			    c_width = canvas.width,
			 			    c_height = canvas.height;

			 			for(var i = 0; i < bufferLength; i++) {
			 			     value = dataArray[i];
			 			     ctx.fillStyle = '#f99';
			 			     ctx.fillRect(i, c_height - value, 1, value);
			 			}

			 		},
				 	function(e) {
				 		console.log("Error with decoding audio data" + e.err)
				 	}
			 	)
			 }
		} catch (err) {
			alert('Your browser does not support AudioContext!')
			console.log(err)
		}
	</script>
</body>
</html>